import{a as Q,b as V}from"./chunk-IEVHK5SN.js";import{a as K}from"./chunk-4NP5SAQA.js";import{a as R,b as z,c as F,d as j,e as $,f as B,g as W,h as Y,i as q,j as G,k as J}from"./chunk-SJPCH2W4.js";import"./chunk-GR6KZ4EE.js";import{a as I,b as k,c as T,d as A,f as U,j as L}from"./chunk-U2PRCF4C.js";import{d as P}from"./chunk-S46PGCVJ.js";import{pa as E,qa as H,ra as N}from"./chunk-CN72DSDW.js";import{i as y,j as D,m as w,n as O}from"./chunk-BRPU6MQJ.js";import{$a as _,$b as o,Eb as n,Fb as a,Gb as c,Hb as f,Ib as h,Rb as u,_a as r,ac as m,bc as p,gc as b,ka as C,kc as M,lc as S,qb as s,vb as l,wb as v,xb as x}from"./chunk-HFY3FSCH.js";function Z(t,e){t&1&&(n(0,"div",15),c(1,"mat-spinner",16),a())}function tt(t,e){t&1&&(n(0,"th",26),o(1,"Name"),a())}function et(t,e){if(t&1&&(n(0,"td",27),o(1),a()),t&2){let i=e.$implicit;r(),m(i.userName)}}function nt(t,e){t&1&&(n(0,"th",26),o(1,"Membership #"),a())}function at(t,e){if(t&1&&(n(0,"td",27),o(1),a()),t&2){let i=e.$implicit;r(),p(" ",i.membershipNumber," ")}}function it(t,e){t&1&&(n(0,"th",26),o(1,"Check In"),a())}function ot(t,e){if(t&1&&(n(0,"td",27),o(1),M(2,"date"),a()),t&2){let i=e.$implicit;r(),p(" ",S(2,1,i.checkInTime,"medium")," ")}}function rt(t,e){t&1&&(n(0,"th",26),o(1,"Status"),a())}function dt(t,e){if(t&1&&(n(0,"td",27)(1,"span",28),o(2),a()()),t&2){let i=e.$implicit;r(),x("active-badge",!i.checkOutTime)("completed-badge",i.checkOutTime),r(),p(" ",i.checkOutTime?"Completed":"Active"," ")}}function lt(t,e){t&1&&c(0,"tr",29)}function st(t,e){t&1&&c(0,"tr",30)}function mt(t,e){if(t&1&&(n(0,"table",17),f(1,18),s(2,tt,2,0,"th",19)(3,et,2,1,"td",20),h(),f(4,21),s(5,nt,2,0,"th",19)(6,at,2,1,"td",20),h(),f(7,22),s(8,it,2,0,"th",19)(9,ot,3,4,"td",20),h(),f(10,23),s(11,rt,2,0,"th",19)(12,dt,3,5,"td",20),h(),s(13,lt,1,0,"tr",24)(14,st,1,0,"tr",25),a()),t&2){let i=u();l("dataSource",i.recentAttendance),r(13),l("matHeaderRowDef",i.displayedColumns),r(),l("matRowDefColumns",i.displayedColumns)}}function ct(t,e){t&1&&(n(0,"div",31)(1,"p"),o(2,"No recent activity to display."),a()())}function pt(t,e){t&1&&(n(0,"div",15),c(1,"mat-spinner",16),a())}function gt(t,e){if(t&1&&(n(0,"div",34)(1,"div",35),o(2),a(),n(3,"div",36)(4,"div",37),o(5),a(),n(6,"div",38)(7,"span",39),o(8),a(),n(9,"span",39),o(10),a()()(),n(11,"div",40)(12,"div",41),c(13,"div",42),a()()()),t&2){let i=e.$implicit,d=e.index,g=u(2);r(2),m(d+1),r(3),m(i.userName),r(3),p("",i.totalCheckins," check-ins"),r(2),p("",i.averageStayDuration," min avg"),r(3),v("width",i.totalCheckins/g.maxCheckins*100,"%")}}function ft(t,e){if(t&1&&(n(0,"div",32),s(1,gt,14,6,"div",33),a()),t&2){let i=u();r(),l("ngForOf",i.topUsers)}}function ht(t,e){t&1&&(n(0,"div",31)(1,"p"),o(2,"No user statistics available."),a()())}var X=class t{constructor(e,i){this.authService=e;this.attendanceService=i}isLoading=!0;users=[];userCount=0;adminCount=0;todayAttendanceCount=0;weeklyAttendanceCount=0;recentAttendance=[];topUsers=[];maxCheckins=0;displayedColumns=["name","membership","checkIn","status"];ngOnInit(){this.loadDashboardData()}loadDashboardData(){this.isLoading=!0,this.authService.getAllUsers().subscribe({next:e=>{this.users=e,this.userCount=e.length,this.adminCount=e.filter(i=>i.role==="admin").length,this.loadAttendanceData()},error:e=>{this.isLoading=!1,console.error("Error loading users:",e)}})}loadAttendanceData(){this.attendanceService.getAllAttendance().subscribe({next:e=>{let i=new Date;i.setHours(0,0,0,0);let d=new Date;d.setDate(d.getDate()-7),d.setHours(0,0,0,0),this.todayAttendanceCount=e.filter(g=>new Date(g.checkInTime).setHours(0,0,0,0)===i.getTime()).length,this.weeklyAttendanceCount=e.filter(g=>new Date(g.checkInTime)>=d).length,this.recentAttendance=e.slice(0,5),this.loadTopUsers()},error:e=>{this.isLoading=!1,console.error("Error loading attendance:",e)}})}loadTopUsers(){this.attendanceService.getAllUserStats().subscribe({next:e=>{this.topUsers=e.sort((i,d)=>d.totalCheckins-i.totalCheckins).slice(0,5),this.maxCheckins=this.topUsers.length>0?this.topUsers[0].totalCheckins:0,this.isLoading=!1},error:e=>{this.isLoading=!1,console.error("Error loading user stats:",e)}})}static \u0275fac=function(i){return new(i||t)(_(P),_(K))};static \u0275cmp=C({type:t,selectors:[["app-dashboard"]],standalone:!0,features:[b],decls:63,vars:10,consts:[[1,"container","dashboard-container"],[1,"page-title"],[1,"dashboard-content"],[1,"stats-grid"],[1,"stat-card","fade-in"],[1,"stat-icon"],[1,"stat-info"],[1,"stat-value"],[1,"stat-label"],[1,"activity-card","slide-up"],["class","loading-spinner",4,"ngIf"],["mat-table","",3,"dataSource",4,"ngIf"],["class","no-data-message",4,"ngIf"],[1,"top-users-card","slide-up"],["class","top-users-list",4,"ngIf"],[1,"loading-spinner"],["diameter","40"],["mat-table","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","membership"],["matColumnDef","checkIn"],["matColumnDef","status"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"status-badge"],["mat-header-row",""],["mat-row",""],[1,"no-data-message"],[1,"top-users-list"],["class","top-user-item",4,"ngFor","ngForOf"],[1,"top-user-item"],[1,"top-user-rank"],[1,"top-user-info"],[1,"top-user-name"],[1,"top-user-stats"],[1,"stat"],[1,"top-user-visits"],[1,"visits-bar"],[1,"visits-fill"]],template:function(i,d){i&1&&(n(0,"div",0)(1,"h1",1),o(2,"Admin Dashboard"),a(),n(3,"div",2)(4,"div",3)(5,"mat-card",4)(6,"mat-card-content")(7,"div",5)(8,"mat-icon"),o(9,"people"),a()(),n(10,"div",6)(11,"h2",7),o(12),a(),n(13,"p",8),o(14,"Total Users"),a()()()(),n(15,"mat-card",4)(16,"mat-card-content")(17,"div",5)(18,"mat-icon"),o(19,"admin_panel_settings"),a()(),n(20,"div",6)(21,"h2",7),o(22),a(),n(23,"p",8),o(24,"Administrators"),a()()()(),n(25,"mat-card",4)(26,"mat-card-content")(27,"div",5)(28,"mat-icon"),o(29,"checkin"),a()(),n(30,"div",6)(31,"h2",7),o(32),a(),n(33,"p",8),o(34,"Today's Check-ins"),a()()()(),n(35,"mat-card",4)(36,"mat-card-content")(37,"div",5)(38,"mat-icon"),o(39,"calendar_today"),a()(),n(40,"div",6)(41,"h2",7),o(42),a(),n(43,"p",8),o(44,"Weekly Check-ins"),a()()()()(),n(45,"mat-card",9)(46,"mat-card-header")(47,"mat-card-title"),o(48,"Recent Activity"),a()(),n(49,"mat-card-content"),s(50,Z,2,0,"div",10)(51,mt,15,3,"table",11)(52,ct,3,0,"div",12),a()(),n(53,"mat-card",13)(54,"mat-card-header")(55,"mat-card-title"),o(56,"Top Members"),a(),n(57,"mat-card-subtitle"),o(58,"Based on attendance"),a()(),n(59,"mat-card-content"),s(60,pt,2,0,"div",10)(61,ft,2,1,"div",14)(62,ht,3,0,"div",12),a()()()()),i&2&&(r(12),m(d.userCount),r(10),m(d.adminCount),r(10),m(d.todayAttendanceCount),r(10),m(d.weeklyAttendanceCount),r(8),l("ngIf",d.isLoading),r(),l("ngIf",!d.isLoading&&d.recentAttendance.length>0),r(),l("ngIf",!d.isLoading&&d.recentAttendance.length===0),r(8),l("ngIf",d.isLoading),r(),l("ngIf",!d.isLoading&&d.topUsers.length>0),r(),l("ngIf",!d.isLoading&&d.topUsers.length===0))},dependencies:[O,y,D,w,L,I,T,U,A,k,E,N,H,J,R,F,W,j,z,Y,$,B,q,G,V,Q],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:24px 16px;max-width:1200px;margin:auto}.page-title[_ngcontent-%COMP%]{margin-bottom:24px;text-align:center;font-size:2rem}.dashboard-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:24px}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:16px}@media (min-width: 576px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (min-width: 992px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}.dashboard-content[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr}.activity-card[_ngcontent-%COMP%]{grid-column:1}.top-users-card[_ngcontent-%COMP%]{grid-column:2;grid-row:2}}.stat-card[_ngcontent-%COMP%]{height:100%;transition:all .3s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:var(--shadow-lg)}.stat-card[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;flex-wrap:wrap}.stat-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background-color:var(--primary-light);color:#fff;width:60px;height:60px;border-radius:50%;margin-right:16px;flex-shrink:0}.stat-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:32px}.stat-info[_ngcontent-%COMP%]{flex:1}.stat-value[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;margin:0;color:var(--gray-900);line-height:1.2}.stat-label[_ngcontent-%COMP%]{color:var(--gray-600);margin:0;font-size:1rem}.activity-card[_ngcontent-%COMP%], .top-users-card[_ngcontent-%COMP%]{overflow:hidden}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:24px}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:16px;font-size:.75rem;font-weight:500}.active-badge[_ngcontent-%COMP%]{background-color:var(--primary-light);color:#fff}.completed-badge[_ngcontent-%COMP%]{background-color:var(--success);color:#fff}.no-data-message[_ngcontent-%COMP%]{text-align:center;padding:24px;color:var(--gray-600)}.top-users-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding:16px 0}.top-user-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;flex-wrap:wrap}.top-user-rank[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;border-radius:50%;background-color:var(--primary);color:#fff;font-weight:600}.top-user-info[_ngcontent-%COMP%]{flex:1}.top-user-name[_ngcontent-%COMP%]{font-weight:500;margin-bottom:4px}.top-user-stats[_ngcontent-%COMP%]{display:flex;gap:16px;font-size:.8rem;color:var(--gray-600);flex-wrap:wrap}.top-user-visits[_ngcontent-%COMP%]{width:100%;max-width:150px}.visits-bar[_ngcontent-%COMP%]{height:8px;background-color:var(--gray-200);border-radius:4px;overflow:hidden}.visits-fill[_ngcontent-%COMP%]{height:100%;background-color:var(--primary);border-radius:4px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}@media (max-width: 768px){.dashboard-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}table[_ngcontent-%COMP%]{display:block;overflow-x:auto;white-space:nowrap}.stat-value[_ngcontent-%COMP%]{font-size:1.5rem}}"]})};export{X as DashboardComponent};
